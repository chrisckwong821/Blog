<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Chris Wong’s Blog</title>
	
	<meta name="author" content="Chris Wong">

	<!-- Enable responsive viewport -->
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
	<!--[if lt IE 9]>
	<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Le styles -->
	<link href="/My-Personal-Blog//assets/resources/bootstrap/css/bootstrap.min.css" rel="stylesheet">
	<link href="/My-Personal-Blog//assets/resources/font-awesome/css/font-awesome.min.css" rel="stylesheet">
	<link href="/My-Personal-Blog//assets/resources/syntax/syntax.css" rel="stylesheet">
	<link href="/My-Personal-Blog//assets/css/style.css" rel="stylesheet">

	<!-- Le fav and touch icons -->
	<!-- Update these with your own images
	<link rel="shortcut icon" href="images/favicon.ico">
	<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
	-->

	<link rel="alternate" type="application/rss+xml" title="" href="/My-Personal-Blog//feed.xml">
</head>

<body>
	<nav class="navbar navbar-default visible-xs" role="navigation">
		<!-- Brand and toggle get grouped for better mobile display -->
		<div class="navbar-header">
			<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			
			<a type="button" class="navbar-toggle nav-link" href="http://github.com//chrisckwong821">
				<i class="fa fa-github"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="http://twitter.com//chrisckwong821">
				<i class="fa fa-twitter"></i>
			</a>
			
			
			<a type="button" class="navbar-toggle nav-link" href="mailto:chrisckwong821@gmail.com">
				<i class="fa fa-envelope"></i>
			</a>
			
			<a class="navbar-brand" href="/My-Personal-Blog//">
				<img src="//www.gravatar.com/avatar/726351295ec82e145928582f595aa3aa?s=35" class="img-circle" />
				Chris Wong
			</a>
		</div>

		<!-- Collect the nav links, forms, and other content for toggling -->
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
			<ul class="nav navbar-nav">
				<li class="active"><a href="/My-Personal-Blog//">Home</a></li>
				<li><a href="/My-Personal-Blog//categories.html">Categories</a></li>
				<li><a href="/My-Personal-Blog//tags.html">Tags</a></li>
			</ul>
		</div><!-- /.navbar-collapse -->
	</nav>

	<!-- nav-menu-dropdown -->
	<div class="btn-group hidden-xs" id="nav-menu">
		<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
			<i class="fa fa-bars"></i>
		</button>
		<ul class="dropdown-menu" role="menu">
			<li><a href="/My-Personal-Blog//"><i class="fa fa-home"></i>Home</a></li>
			<li><a href="/My-Personal-Blog//categories.html"><i class="fa fa-folder"></i>Categories</a></li>
			<li><a href="/My-Personal-Blog//tags.html"><i class="fa fa-tags"></i>Tags</a></li>
			<li class="divider"></li>
			<li><a href="#"><i class="fa fa-arrow-up"></i>Top of Page</a></li>
		</ul>
	</div>

	<div class="col-sm-3 sidebar hidden-xs" style="">
		<!-- sidebar.html -->
<header class="sidebar-header" role="banner">
	<a href="/My-Personal-Blog//">
		<img src="//www.gravatar.com/avatar/726351295ec82e145928582f595aa3aa?s=150" class="img-circle" />
	</a>
	<h3 class="title">
        <a href="/My-Personal-Blog//">Chris Wong</a>
    </h3>
</header>


<div id="bio" class="text-center">
	Python Developer
</div>


<div id="contact-list" class="text-center">
	<ul class="list-unstyled list-inline">
		
		<li>
			<a class="btn btn-default btn-sm" href="https://github.com//chrisckwong821">
				<i class="fa fa-github-alt fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://twitter.com//chrisckwong821">
				<i class="fa fa-twitter fa-lg"></i>
			</a>
		</li>
		
		
		<li>
			<a class="btn btn-default btn-sm" href="mailto:chrisckwong821@gmail.com">
				<i class="fa fa-envelope fa-lg"></i>
			</a>
		</li>
		
	</ul>
	<ul id="contact-list-secondary" class="list-unstyled list-inline">
		
		
		<li>
			<a class="btn btn-default btn-sm" href="https://linkedin.com/in/https://www.linkedin.com/in/chris-chun-kau-wong-8a05bba4/">
				<i class="fa fa-linkedin fa-lg"></i>
			</a>
		</li>
		
		<li>
			<a class="btn btn-default btn-sm" href="/My-Personal-Blog//feed.xml">
				<i class="fa fa-rss fa-lg"></i>
			</a>
		</li>
	</ul>
</div>
<!-- sidebar.html end -->

	</div>

	<div class="col-sm-9 col-sm-offset-3">
		<div class="page-header">
  <h1>Chris Wong’s Blog </h1>
</div>



<article class="home">

  <span class="post-date">
    
    August
    26th,
    
    2017
  </span>

  <h2>
    <a href="/My-Personal-Blog//financial%20trading/2017/08/26/HSI-3.html">Understanding HSI - III - The Best EWMA Pair</a>
  </h2>

  <div>
    
    <p>Inspired by <strong><a href="https://www.facebook.com/brian.wong.7509?ref=br_rs">Brian</a></strong>, who is specialised in corporate finance, I would like to test the optimal EWMA pairs that generate the best short signal. In general, It is said that momentum is a good type of signals to capture upward movement, while EWMA crossing is the one for downward movement.</p>

<p>Here I would like to test which two EWMA crossing would generate the best performance for Hang Seng Index.</p>

<p>Just to describe the method briefly, when the more sensitive (EWMA of 10 days relative to EWMA of 20 days) EWMA plunges the less sensitive EWMA, we open a short contract, and hold the contract until the more sensitive EWMA breaks through the less sensitive one. The difference in index is our profit and loss.</p>

<p>The test data is from 2009 - 2017. I skipped financial crisis because the big downward movement would create bias for more sensitive pairs. I want to test out the best pair of EWMA under most of the circumstance, but not assuming we have to undergo another financial crisis. Some of you may disagree with this since including data from 2007 to 2008 seems to make the test more robust. However, robustness comes with tradeoff in performance. I aim to discover an optimised strategy that can be run most of the time, but not a general one that can be run and left alone. This is in fact, more efficient and practical since we apply some judging or other out-of-model analysis on whether or not we should adopt this strategy in the first place, making the model more nitche and fit for the current case.  In this case, since we are talking about shorting, skipping financial crisis would make our signal more profitable under general situations.</p>

<p>I brute-forced the profit of two set of EWMA signal, 2-60 days for the faster average and 100 to 250 days for the slower average. I would post the code at the end of this article(Python) so you can test any custom range of signals.</p>

<p><img src="http://localhost:4000/assets/media/HSI/HSI3/Profit.png" alt="The Most Profitable Pairs" /></p>

<p>Basically the results comes in line with our general understanding. For the most profitable(in terms of total profit), the use of 20/103 pair tops the list. Pairs around this range have similar performance so it is pretty stable.</p>

<p>In terms of the most efficient trade, amazingly, the performance of 59/237 and pairs around this range have super positive results, smaller loss and even SD.</p>

<p><img src="http://localhost:4000/assets/media/HSI/HSI3/PPT.png" alt="The Most Efficient Pairs" /></p>

<p>The Code for the testing:</p>

<p>Download Index_09-17.csv on <strong><a href="https://github.com/chrisckwong821/My-Personal-Blog/blob/gh-pages/assets/Reference/HSI-3/Index_09-17.csv">here</a></strong></p>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="k">class</span> <span class="nc">backend</span><span class="p">:</span>
   <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
       <span class="c">#load data</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'Index_09-17.csv'</span><span class="p">,</span><span class="n">error_bad_lines</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
       <span class="c">#set index for rolling window later</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s">'Date'</span><span class="p">))</span>
       <span class="c">#replace null with previous values</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">'Adj Close'</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">to_replace</span><span class="o">=</span><span class="s">'null'</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s">'ffill'</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">'Open'</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">to_replace</span><span class="o">=</span><span class="s">'null'</span><span class="p">,</span><span class="n">method</span><span class="o">=</span><span class="s">'ffill'</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
       <span class="c"># convert to numeric</span>
       <span class="bp">self</span><span class="o">.</span><span class="n">close</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">'Adj Close'</span><span class="p">])</span>
       <span class="bp">self</span><span class="o">.</span><span class="nb">open</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">'Open'</span><span class="p">])</span>
       
   <span class="c">#output df of EWMA transformation    </span>
   <span class="k">def</span> <span class="nf">EWMA</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">num</span><span class="p">):</span>
       <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">'{}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num</span><span class="p">):</span><span class="bp">self</span><span class="o">.</span><span class="n">close</span><span class="o">.</span><span class="n">ewm</span><span class="p">(</span><span class="n">span</span><span class="o">=</span><span class="n">num</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()})</span>
       
   <span class="c">#create signal that compare two EWMA columns</span>
   <span class="k">def</span> <span class="nf">signal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fast</span><span class="p">,</span><span class="n">slow</span><span class="p">):</span>
       <span class="n">signal</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">EWMA</span><span class="p">(</span><span class="n">fast</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">EWMA</span><span class="p">(</span><span class="n">slow</span><span class="p">)],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
       <span class="k">return</span> <span class="n">signal</span><span class="p">[</span><span class="s">'{}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fast</span><span class="p">)]</span><span class="o">&lt;</span><span class="n">signal</span><span class="p">[</span><span class="s">'{}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">slow</span><span class="p">)]</span>
       
   <span class="c">#compute PnL of custom EWMA pairs</span>
   <span class="k">def</span> <span class="nf">PnL</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fast</span><span class="p">,</span><span class="n">slow</span><span class="p">):</span>
       <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="n">fast</span><span class="p">,</span><span class="n">slow</span><span class="p">)</span>
       <span class="n">holding</span> <span class="o">=</span> <span class="bp">False</span>
       <span class="n">pnL_histroy</span> <span class="o">=</span> <span class="p">[]</span>
       <span class="n">entry</span> <span class="o">=</span> <span class="mi">0</span>
       <span class="nb">exit</span> <span class="o">=</span> <span class="mi">0</span>
       <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
           <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="bp">True</span><span class="p">:</span>
               <span class="k">if</span> <span class="n">holding</span> <span class="o">==</span> <span class="bp">False</span><span class="p">:</span>
                   <span class="n">entry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="nb">open</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                   <span class="n">holding</span> <span class="o">=</span> <span class="bp">True</span>
               <span class="k">else</span><span class="p">:</span>
                   <span class="k">pass</span>
           <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="bp">False</span><span class="p">:</span>
               <span class="k">if</span> <span class="n">holding</span> <span class="o">==</span> <span class="bp">False</span><span class="p">:</span>
                   <span class="k">pass</span>
               <span class="k">else</span><span class="p">:</span>
                   <span class="nb">exit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="nb">open</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
                   <span class="n">pnL_histroy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">exit</span><span class="o">-</span><span class="n">entry</span><span class="p">)</span>
                   <span class="n">holding</span> <span class="o">=</span> <span class="bp">False</span>
       <span class="c">#profit, number of trade, profit per trade,SD, maxprofit, max loss</span>
       <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">pnL_histroy</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">pnL_histroy</span><span class="p">),</span><span class="nb">sum</span><span class="p">(</span><span class="n">pnL_histroy</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">pnL_histroy</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">pnL_histroy</span><span class="p">),</span><span class="nb">max</span><span class="p">(</span><span class="n">pnL_histroy</span><span class="p">),</span><span class="nb">min</span><span class="p">(</span><span class="n">pnL_histroy</span><span class="p">)</span>
       
   <span class="c"># make it nicer for one-line output to csv</span>
   <span class="k">def</span> <span class="nf">output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">fastl</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">fastu</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">slowl</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span><span class="n">slowu</span><span class="o">=</span><span class="mi">250</span><span class="p">):</span>
       <span class="n">index</span><span class="p">,</span><span class="n">profit</span><span class="p">,</span><span class="n">number</span><span class="p">,</span><span class="n">GPT</span><span class="p">,</span><span class="n">SD</span><span class="p">,</span><span class="n">MP</span><span class="p">,</span><span class="n">ML</span> <span class="o">=</span> <span class="p">[],[],[],[],[],[],[]</span>
       <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">fastl</span><span class="p">,</span><span class="n">fastu</span><span class="p">):</span>
           <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">slowl</span><span class="p">,</span><span class="n">slowu</span><span class="p">):</span>
               <span class="n">p</span><span class="p">,</span><span class="n">num</span><span class="p">,</span><span class="n">gpt</span><span class="p">,</span><span class="n">sd</span><span class="p">,</span><span class="n">mp</span><span class="p">,</span><span class="n">ml</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PnL</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>
               <span class="n">index</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">))</span>
               <span class="n">profit</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
               <span class="n">number</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
               <span class="n">GPT</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gpt</span><span class="p">)</span>
               <span class="n">SD</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sd</span><span class="p">)</span>
               <span class="n">MP</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mp</span><span class="p">)</span>
               <span class="n">ML</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ml</span><span class="p">)</span>
       <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s">'index'</span><span class="p">:</span><span class="n">index</span><span class="p">,</span><span class="s">'profit'</span><span class="p">:</span><span class="n">profit</span><span class="p">,</span><span class="s">'number of trade'</span><span class="p">:</span><span class="n">number</span><span class="p">,</span>
       <span class="s">'Average Gain'</span><span class="p">:</span><span class="n">GPT</span><span class="p">,</span><span class="s">'SD'</span><span class="p">:</span><span class="n">SD</span><span class="p">,</span><span class="s">'Maximum Gain in One Trade'</span><span class="p">:</span><span class="n">MP</span><span class="p">,</span><span class="s">'Maximum Loss in One Trade'</span><span class="p">:</span><span class="n">ML</span><span class="p">})</span>
       <span class="k">return</span> <span class="n">df</span><span class="p">[[</span><span class="s">'index'</span><span class="p">,</span><span class="s">'profit'</span><span class="p">,</span><span class="s">'number of trade'</span><span class="p">,</span><span class="s">'Average Gain'</span><span class="p">,</span><span class="s">'SD'</span><span class="p">,</span><span class="s">'Maximum Gain in One Trade'</span><span class="p">,</span><span class="s">'Maximum Loss in One Trade'</span><span class="p">]]</span>
       
       <span class="c">###change the output(a,b,c,d) for your own range </span>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
   <span class="n">output</span> <span class="o">=</span> <span class="n">backend</span><span class="p">()</span><span class="o">.</span><span class="n">output</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">250</span><span class="p">)</span>
   <span class="n">output</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">'result.csv'</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span></code></pre></figure>


    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    August
    15th,
    
    2017
  </span>

  <h2>
    <a href="/My-Personal-Blog//financial%20trading/2017/08/15/HSI-2.html">Understanding HSI - II - Fundament of HSI</a>
  </h2>

  <div>
    
    <p>Before going into another session of analysis on HSI, it is good, if not necessary, to know how the index is computed from its constituents mathematically. Here is a list of must-know fact that tells you how HSI is reported.</p>

<p>Fundamental:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>- HSI is an equity index that consists of 50 blue chip stocks listed in HKEx.
- Based on the July report 2017, the index represents 57% of total market value and 49% of turnover in HKEx
- However the 7 biggest stocks already account for half of the weighting, namely. Tencent(10.96%), HSBC Holding(10.91%), AIA(8.58%), CCB(8.13%), China Mobile(5.95%) and ICBC(4.67%). Noted that Financials stocks account for 48.75% of the weighting.
</code></pre>
</div>

<p>On total return:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>- HSI is a basket of 40 blue-chip stocks. Just like any equity, it would distribute dividend every half year. Thus the index would be discounted whenever dividends are distributed. To compute the absolute return of HSI, you need to look into the HSI total return index which takes into account of the historical dividends.
</code></pre>
</div>

<p>For computational methodology, I would explain it below. But you may go straight to the <strong><a href="http://www.hsi.com.hk/HSI-Net/static/revamp/contents/en/dl_centre/brochures/Methodology_E.pdf">reference</a></strong> if you like documentation.</p>

<p>According to HSI Company, the index is free float-adjusted MV weight index with a 10% cap on individual securities.What does that even mean? The statement can be broken in three elements:</p>

<ol>
  <li>free float-adjusted</li>
  <li>MV weight</li>
  <li>10% cap.</li>
</ol>

<p>I would explain them one by one. But let’s look at the real formula:</p>

<p><img src="http://localhost:4000/assets/media/HSI/HSI2/formula.jpeg" alt="Formular to compute HSI" /></p>

<p>In the most generic terms, the index takes into account 4 factors:</p>

<ol>
  <li>Price</li>
  <li>Issued shares</li>
  <li>FAF</li>
  <li>CF</li>
</ol>

<p>It measures their ratios relative to values yesterday, and multiply by the closing index yesterday. Since both FAF and CF adjust <strong>quarterly</strong>(Super important!), the index primarily behaves no different from a market-cap based index, except it is interrupted by quarter adjustment.</p>

<p>Market Value(MV): Price multiply by number of issued shares</p>

<p>Free float-adjusted factor: Adjusted quarterly based on the liquidity of the issued shares. Reflect whether the proportion of shares are held by big corporations or shareholders only or other investors.</p>

<p>10% cap: The maximum influence of individual stock on the index is capped at 10%. As of now (As of 14/8/2017), there only two stocks which reach this limit. HSBC and Tencent, only 53% and 59% of their capitalisations are accounted into HSI respectively.</p>

<p>However, as you may notice, one stock may also exceed 10% cap if it surges after the quarter rebalancing of FAF and CF. In addition, if a constituent is excluded from the index, the index would recount so influence of individual stocks may exceed the 10% cap as well.</p>

    
  </div>

</article>


<article class="home">

  <span class="post-date">
    
    August
    2nd,
    
    2017
  </span>

  <h2>
    <a href="/My-Personal-Blog//financial%20trading/2017/08/02/HSI-1.html">Understand HSI - I - Trending or reversible?</a>
  </h2>

  <div>
    
    <p>There are a lot of unofficial beliefs on HSI, including a bottom in May and peak in July.
Instead of backtesting for a particular one or two signals, I want to offer a programatic way of knowing how HSI behaves in the past decade. In the first episode, which is this article, I want to apply simple strategy, just to demonstrate my logic and how programs can be used to examine our trading ideas more objectively.
Before diving into the content, I want to highlight the fact that I am just testing HSI, not even its future or any derivative. So this article would be of research in nature. It does not and should not be directly implemented into a trading strategy unless you want to play dice.
So here comes the meat. Is HSI a trendy or a reversible index? This is a qualitative question, which we usually ask in conversation. A more investment-oriented one would be HOW MUCH? Now,</p>

<p><img src="http://localhost:4000/assets/media/HSI/HSI1/Long.png" alt="Long Strategy" /></p>

<p>This table lists the PnL of trend-following trading. The first row means to start buying after one up-move day. Buy in opening, sell at close, take the spread, that simple. The second row means to long only after two consecutive up days, take the spread of the 3-rd day. If it is an up day, then continue to long on the 4th day, until a down to break the trend, then recount the next up day as day 1, so on and so fro…
Clearly, to start buying on the 2nd to 7th day is a loser strategy, contrary to start buying after the very first upward move. However this strategy is a simple one considering the gain per trade (13p) and huge standard deviation, not to mentioned the drastic minimum and maximum gain compare to the average one.
Amazingly, there are many possible ways to make improvement revealed in this simple table. First, you would notice profit is generated mainly from the 2nd up days. As soon as you go long after HSI moves up for two consecutive days. Chances are, you would not make much money.</p>

<p><img src="http://localhost:4000/assets/media/HSI/HSI1/OneDayLong.png" alt="One-day Long Strategy" /></p>

<p>Bang! This is the PnL of longing only after the first up day, and just for ONE DAY. You get more profit but trade half of times, This buffs up gain per trade to 29p.
Second possible improvement is, to incorporate some shorting. From the first table, we observe start longing after 3rd to 7th up days seriously bankrupt you, lets test the effect.</p>

<p><img src="http://localhost:4000/assets/media/HSI/HSI1/ODLand.png" alt="One-day Long and Continuous Short Strategy" /></p>

<p>This is the PnL of two strategies, long after the first up move day for ONE DAY, start shorting after the up trend continues for certain day. The first row is to short after 2 up days, the second row is to short after 3 up days…etc.
It does not improve compared to long only, isn’t it? What if we only short one day?</p>

<p><img src="http://localhost:4000/assets/media/HSI/HSI1/ODLS.png" alt="One-day Long and One-day Short Strategy" /></p>

<p>Again the improvement is insignificant.
(Summary) — All we have considered, is just a pure switch of up/down. And we come up 30p gain per trade by simply long right after any upward day, for the next ONE DAY ONLY.
Lets add more complexity by considering the momentum. There are many innovative ways of measuring momentum. The simplest way to proxy momentum is by how much the close price is below the daily high. The closer these two prices are, the more bullish it is.
Convention would suggest the tighter the threshold, meaning that the closer the close price is to daily high the more likely the price on next day would shoot up. Practically, how tight should it be? I have tested the long threshold from 1 to 150 points. There are a lot of irregularity when the threshold is too small. The gpt only stabilizes at 50 and reach the peak at 94 points. So it means any day with a close price within 94 points of daily high is worth a shot.</p>

<p>Honestly I don’t like charting because it is simply not representative of the data. But to give you a visual favor I output a chart anyway. Standard deviation basically decreases as number of trades increases with threshold so I decided to keep them in the background.</p>

<p><img src="http://localhost:4000/assets/media/HSI/HSI1/lastcurve.jpg" alt="Summary" /></p>

<p>Generally speaking, it is true that the looser the threshold, the more trade and profit you would have, but sacrificing the level of gain per trade. Having said that, picking the right sweet spot for each product requires programmatic testing.</p>

    
  </div>

</article>

<hr/>

<ul class="pager"> 

  
  <li class="previous disabled">
    <a>&larr; Newer</a>
  </li>
  
  
  <li>
    <span class="page_number">Page: 1 of 1</span>
  </li>

  
  <li class="next disabled">
    <a>Older &rarr;</a>        
  </li>
  

</ul>




		<footer>
			<hr/>
			<p>
				&copy; 2017 Chris Wong with <a href="http://jekyllrb.com/">Jekyll</a>. Theme: <a href="https://github.com/dbtek/dbyll">dbyll</a> by dbtek.
			</p>
		</footer>
	</div>

	<script type="text/javascript" src="/My-Personal-Blog//assets/resources/jquery/jquery.min.js"></script>
	<script type="text/javascript" src="/My-Personal-Blog//assets/resources/bootstrap/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="/My-Personal-Blog//assets/js/app.js"></script>
</body>
</html>



<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'dbyll', 'auto');
  ga('send', 'pageview');
</script>

